<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyrpl.widgets.module_widgets.base_module_widget &#8212; pyrpl 0.9.7.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/bootstrap-sphinx.css?v=4468db6d" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=fd3f3429" />
    <script src="../../../../_static/documentation_options.js?v=cf93a8f2"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../../../../_static/icon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../../../_static/bootstrap-sphinx.js"></script>

  </head><body>
  

  <style id="ribbon">
    #forkongithub a{background:#c11;color:#fff;text-decoration:none;font-family:arial,sans-serif;text-align:center;font-weight:bold;padding:5px 40px;font-size:1rem;line-height:2rem;position:relative;transition:0.5s;}
    #forkongithub a:hover{background:#1c1;color:#fff;}
    #forkongithub a::before,
    #forkongithub a::after{content:"";width:100%;display:block;position:absolute;top:1px;left:0;height:1px;background:#fff;}
    #forkongithub a::after{bottom:1px;top:auto;}@media screen and (min-width:800px)
    { #forkongithub{position:fixed;display:block;top:0;right:0;width:200px;overflow:hidden;height:200px;z-index:9999;}#forkongithub a{width:200px;position:absolute;top:45px;right:-45px;transform:rotate(45deg);-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);-moz-transform:rotate(45deg);-o-transform:rotate(45deg);box-shadow:4px 4px 10px rgba(0,0,0,0.8);}}
  </style>
  <span id="forkongithub"><a href="https://www.github.com/lneuhaus/pyrpl#fork-destination-box">Fork PyRPL on GitHub</a></span>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-102689373-2', 'auto');
    ga('send', 'pageview');

  </script>


  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../../index.html">
          PyRPL</a>
        <span class="navbar-text navbar-version pull-left"><b>0.9.7.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../../index.html">Home</a></li>
                <li><a href="../../../../installation.html">Installation</a></li>
                <li><a href="../../../../gui.html">Graphical user interface</a></li>
                <li><a href="../../../../api.html">API</a></li>
                <li><a href="../../../../basics.html">How PyRPL works</a></li>
                <li><a href="../../../../developer_guide/index.html">Infos for Developers</a></li>
            
            
              
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <h1>Source code for pyrpl.widgets.module_widgets.base_module_widget</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The basic functionality of all module widgets are inherited from the base</span>
<span class="sd">class :class:`.ModuleWidget`.</span>

<span class="sd">A module widget is delimited by a dashed-line (a QGroupBox). The following</span>
<span class="sd">menu is available on the top part of each ModuleWidget, directly behind the</span>
<span class="sd">name of the module (e.g. :code:`pid0`, :code:`pid1`, ...). Right click on</span>
<span class="sd">the item (e.g. :code:`.:Load:.`, :code:`.:Save:.`, ...) to access the associated</span>
<span class="sd">submenu:</span>

<span class="sd">* :code:`.:Load:.` Loads the state of the module from a list of previously saved states.</span>
<span class="sd">* :code:`.:Save:.` Saves the current state under a given state name.</span>
<span class="sd">* :code:`.:Erase:.` Erases one of the previously saved states.</span>
<span class="sd">* :code:`.:Edit:.` Opens a text window to edit the yml code of a state.</span>
<span class="sd">* :code:`.:Hide/Show:.` Hides or shows the content of the module widget.</span>

<span class="sd">Inside the module widget, different attribute values can be manipulated using</span>
<span class="sd">the shown sub-widgets (e.g. :code:`input`, :code:`setpoint`, :code:`max_voltage`, ...). The</span>
<span class="sd">modifications will take effect immediately. Only the module state</span>
<span class="sd">:code:`&lt;current state&gt;` is affected by these changes. Saving the state under</span>
<span class="sd">a different name only preserves the state at the moment of saving for later</span>
<span class="sd">retrieval.</span>

<span class="sd">At the next startup with the same config file, the :code:&lt;current state&gt; of</span>
<span class="sd">all modules is loaded.</span>

<span class="sd">If a module-widget is grayed out completely, it has been reserved by another,</span>
<span class="sd">higher-level module whose name appears in parentheses after the name of the</span>
<span class="sd">module (e.g. :code:`pid2 (output1)` means that the module :code:`pid2` is</span>
<span class="sd">being used by the module :code:`output1`, which is actually a submodule of the</span>
<span class="sd">:code:`lockbox` module). You can right-click anywhere on the grayed out</span>
<span class="sd">widget and click on &quot;Free&quot; to override that reservation and use the module</span>
<span class="sd">for your own purposes.</span>

<span class="sd">.. warning:: If you override a module reservation, the module in parenthesis</span>
<span class="sd">             might stop to function properly. A better practice is to identify</span>
<span class="sd">             the top-level module responsible for the reservation, remove its</span>
<span class="sd">             name from the list in your configuration file (located at</span>
<span class="sd">             /HOME/pyrpl_user_dir/config/&lt;string_shown_in_top_bar_of_the_gui&gt;.yml)</span>
<span class="sd">             and restart PyRPL with that configuration.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qtpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..yml_editor</span><span class="w"> </span><span class="kn">import</span> <span class="n">YmlEditor</span>


<div class="viewcode-block" id="MyMenuLabel">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.MyMenuLabel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">MyMenuLabel</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A label on top of the menu widget that is able to display save or load menu.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module_widget</span> <span class="o">=</span> <span class="n">module_widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">=</span> <span class="n">module_widget</span><span class="o">.</span><span class="n">module</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyMenuLabel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">module_widget</span><span class="p">)</span>

<div class="viewcode-block" id="MyMenuLabel.get_menu">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.MyMenuLabel.get_menu">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">states</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">state</span><span class="p">))</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">menu</span></div>


<div class="viewcode-block" id="MyMenuLabel.contextMenuEvent">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.MyMenuLabel.contextMenuEvent">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">contextMenuEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_menu</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">menu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">exec_</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">globalPos</span><span class="p">())</span></div>
</div>



<div class="viewcode-block" id="LoadLabel">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.LoadLabel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">LoadLabel</span><span class="p">(</span><span class="n">MyMenuLabel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;Load&quot; label</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot; .:Load:. &quot;</span>
<div class="viewcode-block" id="LoadLabel.func">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.LoadLabel.func">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="SaveLabel">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.SaveLabel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">SaveLabel</span><span class="p">(</span><span class="n">MyMenuLabel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;Save&quot; label</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot; .:Save:. &quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_widget</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SaveLabel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">module_widget</span><span class="p">)</span>

<div class="viewcode-block" id="SaveLabel.func">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.SaveLabel.func">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">save_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></div>


<div class="viewcode-block" id="SaveLabel.get_menu">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.SaveLabel.get_menu">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SaveLabel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_menu</span><span class="p">()</span>
        <span class="n">action_new</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;&lt;New...&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">action_new</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_state</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action_new</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">menu</span></div>


<div class="viewcode-block" id="SaveLabel.new_state">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.SaveLabel.new_state">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">new_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span><span class="p">,</span> <span class="n">accept</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Save </span><span class="si">%s</span><span class="s2"> &quot;</span>
                            <span class="s2">&quot;state&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;Enter new state name:&quot;</span><span class="p">)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">accept</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">states</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s2">&quot;State </span><span class="si">%s</span><span class="s2"> of module </span><span class="si">%s</span><span class="s2"> already exists!&quot;</span><span class="o">%</span><span class="p">(</span>
                    <span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">save_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="EraseLabel">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.EraseLabel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">EraseLabel</span><span class="p">(</span><span class="n">MyMenuLabel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;Erase&quot; label</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot; .:Erase:. &quot;</span>

<div class="viewcode-block" id="EraseLabel.func">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.EraseLabel.func">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">erase_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="EditLabel">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.EditLabel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">EditLabel</span><span class="p">(</span><span class="n">MyMenuLabel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;Edit&quot; label</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot; .:Edit:. &quot;</span>

<div class="viewcode-block" id="EditLabel.func">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.EditLabel.func">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">editor</span> <span class="o">=</span> <span class="n">YmlEditor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module_widget</span><span class="o">.</span><span class="n">yml_editors</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;__&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="n">state</span><span class="p">)]</span> <span class="o">=</span> <span class="n">editor</span>
        <span class="n">editor</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="EditLabel.get_menu">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.EditLabel.get_menu">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">EditLabel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_menu</span><span class="p">()</span>
        <span class="n">action_current</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;&lt;Current&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">action_current</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="n">others</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">others</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">others</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">insertAction</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">action_current</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action_current</span><span class="p">)</span> <span class="c1"># will append the action at the end</span>
        <span class="k">return</span> <span class="n">menu</span></div>
</div>



<div class="viewcode-block" id="HideShowLabel">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.HideShowLabel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">HideShowLabel</span><span class="p">(</span><span class="n">MyMenuLabel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;Hide/Show&quot; label</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot; .:Hide/Show:. &quot;</span>

<div class="viewcode-block" id="HideShowLabel.get_menu">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.HideShowLabel.get_menu">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">module_widget</span><span class="o">.</span><span class="n">show_widget</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">module_widget</span><span class="o">.</span><span class="n">hide_widget</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">None</span></div>
</div>



<div class="viewcode-block" id="ReducedModuleWidget">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ReducedModuleWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for a module Widget.</span>

<span class="sd">    In general, this is one of the DockWidget of the Pyrpl MainWindow.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attribute_changed</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">()</span>
    <span class="n">title_pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ReducedModuleWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">=</span> <span class="n">module</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attribute_widgets</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yml_editors</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># optional widgets to edit the yml code of module on a per-state basis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_gui</span><span class="p">()</span> <span class="c1"># performs the automatic gui creation based on register_names</span>
        <span class="c1"># self.setStyleSheet(&quot;ModuleWidget{border:0;color: transparent;}&quot;) # frames and title hidden for software_modules</span>
                                        <span class="c1"># ModuleManagerWidget sets them visible for the HardwareModuleWidgets...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_title_bar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_ownership</span><span class="p">()</span> <span class="c1"># also sets the title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">_signal_launcher</span><span class="o">.</span><span class="n">connect_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="ReducedModuleWidget.init_main_layout">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.init_main_layout">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">init_main_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root_layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_widget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_widget</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;vertical&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.show_widget">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.show_widget">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">show_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; shows the widget after it has been hidden &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_widget</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.hide_widget">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.hide_widget">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">hide_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; shows the widget after it has been hidden &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_widget</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.init_gui">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.init_gui">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">init_gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        To be overwritten in derived class</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_main_layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_attribute_layout</span><span class="p">()</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.init_attribute_layout">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.init_attribute_layout">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">init_attribute_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Automatically creates the gui properties for the register_widgets in register_names.</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">_gui_attributes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attributes_layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attributes_layout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attribute_layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attributes_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute_layout</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attribute_layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute_layout</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">_gui_attributes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attr_name</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attribute_layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attributes_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute_layout</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attribute_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>  <span class="c1"># needed for</span>
                <span class="c1"># passing the instance to the descriptor</span>
                <span class="n">attribute</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">attribute</span><span class="p">):</span>
                    <span class="c1"># assume that attribute is a function</span>
                    <span class="n">widget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># standard case: make attribute widget</span>
                    <span class="n">widget</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">_create_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">widget</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">value_changed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute_changed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attribute_widgets</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">widget</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attribute_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attribute_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.update_attribute_by_name">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.update_attribute_by_name">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_attribute_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">new_value_list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SLOT: don&#39;t change name unless you know what you are doing</span>
<span class="sd">        Updates a specific attribute. New value is passed as a 1-element list</span>
<span class="sd">        to avoid typing problems in signal-slot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">_gui_attributes</span><span class="p">:</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute_widgets</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)]</span>
            <span class="k">try</span><span class="p">:</span>  <span class="c1"># try to propagate the change of attribute to the widget</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">update_attribute_by_name</span><span class="p">(</span><span class="n">new_value_list</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>  <span class="c1"># directly set the widget value otherwise</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attribute_widgets</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)]</span><span class="o">.</span><span class="n">widget_value</span> <span class="o">=</span> <span class="n">new_value_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.change_options">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.change_options">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">change_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select_attribute_name</span><span class="p">,</span> <span class="n">new_options</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SLOT: don&#39;t change name unless you know what you are doing</span>
<span class="sd">        New options should be displayed for some SelectAttribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">select_attribute_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">_gui_attributes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attribute_widgets</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">select_attribute_name</span><span class="p">)]</span><span class="o">.</span><span class="n">change_options</span><span class="p">(</span><span class="n">new_options</span><span class="p">)</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.refresh_filter_options">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.refresh_filter_options">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">refresh_filter_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_attribute_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SLOT: don&#39;t change name unless you know what you are doing</span>
<span class="sd">        New options should be displayed for some FilterProperty.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filter_attribute_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">_gui_attributes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attribute_widgets</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span>
                <span class="n">filter_attribute_name</span><span class="p">)]</span><span class="o">.</span><span class="n">refresh_options</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">)</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.change_ownership">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.change_ownership">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">change_ownership</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SLOT: don&#39;t change name unless you know what you are doing</span>
<span class="sd">        Display the new ownership</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#name = self.module.pyrpl.name + &quot; - &quot; + self.module.name</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">owner</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.set_title">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.set_title">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.create_title_bar">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.create_title_bar">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_title_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># manage spacings of title bar / box around module</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span><span class="p">]:</span>
            <span class="n">v</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">v</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>


<div class="viewcode-block" id="ReducedModuleWidget.save_curve">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ReducedModuleWidget.save_curve">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the curve in some database system.</span>
<span class="sd">        To change the database system, overwrite this function</span>
<span class="sd">        or patch Module.curvedb if the interface is identical.</span>

<span class="sd">        :param  x_values: numpy array with x values</span>
<span class="sd">        :param  y_values: numpy array with y values</span>
<span class="sd">        :param  attributes: extra curve parameters (such as relevant module settings)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve_class</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                    <span class="n">y_values</span><span class="p">,</span>
                                    <span class="o">**</span><span class="n">attributes</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">attributes</span><span class="p">[</span><span class="s2">&quot;curve_name&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">c</span></div>
</div>



<div class="viewcode-block" id="ModuleWidget">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ModuleWidget">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ModuleWidget</span><span class="p">(</span><span class="n">ReducedModuleWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for a module Widget. In general, this is one of the DockWidget of the Pyrpl MainWindow.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="ModuleWidget.set_title">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ModuleWidget.set_title">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="n">title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;title_label&quot;</span><span class="p">):</span> <span class="c1"># ModuleManagerWidgets don&#39;t have a title_label</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">adjustSize</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">title_pos</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_label</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">title_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_label</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_label</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">load_label</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">erase_label</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_label</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">save_label</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_label</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">erase_label</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">erase_label</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hideshow_label</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_label</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">edit_label</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">title_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>


<div class="viewcode-block" id="ModuleWidget.create_title_bar">
<a class="viewcode-back" href="../../../../indices_and_tables/pyrpl.widgets.module_widgets.html#pyrpl.widgets.module_widgets.base_module_widget.ModuleWidget.create_title_bar">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_title_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;yo&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
         <span class="c1"># title should be at the top-left corner of the widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_label</span> <span class="o">=</span> <span class="n">LoadLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_label</span><span class="o">.</span><span class="n">adjustSize</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_label</span> <span class="o">=</span> <span class="n">SaveLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_label</span><span class="o">.</span><span class="n">adjustSize</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">erase_label</span> <span class="o">=</span> <span class="n">EraseLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">erase_label</span><span class="o">.</span><span class="n">adjustSize</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edit_label</span> <span class="o">=</span> <span class="n">EditLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_label</span><span class="o">.</span><span class="n">adjustSize</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hideshow_label</span> <span class="o">=</span> <span class="n">HideShowLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hideshow_label</span><span class="o">.</span><span class="n">adjustSize</span><span class="p">()</span>

        <span class="c1"># self.setStyleSheet(&quot;ModuleWidget{border: 1px dashed gray;color: black;}&quot;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;ModuleWidget{margin: 0.1em; margin-top:0.6em; border: 1 dotted gray;border-radius:5}&quot;</span><span class="p">)</span>
        <span class="c1"># margin-top large enough for border to be in the middle of title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>
</div>

</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2014-2025, Leonhard Neuhaus, Samuel Delglise, Michal Croquette .<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.4.7.<br/>
    </p>
  </div>
</footer>
  </body>
</html>